* How do create a query that returns both the aggregated value and scalar value unchanged in datalog? [[datalog]] [[SQL]] 
[[https://www.learndatalogtoday.org/chapter/7][Learn Datalog Today!]]
Say I have a table movie with columns title, category and rating as its columns, I want to create a table that has title, category, category_average_rating and rating as its columns. How do I do that?In postgresql, we can do that with [PostgreSQL: Documentation: 15: 3.5.Â Window Functions](https://www.postgresql.org/docs/current/tutorial-window.html).